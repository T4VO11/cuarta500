<div class="container mt-4">

    <button class="btn btn-secondary mb-4" (click)="regresar()" [disabled]="isSaving">
        <i class="bi bi-arrow-left"></i> Cancelar y Regresar
    </button>
    
    <div *ngIf="isLoading" class="alert alert-info">Cargando reglamento para edición...</div>

    <div *ngIf="!isLoading" class="card shadow-lg border-0 rounded-4">
        <div class="card-header bg-warning text-dark">
            <h3 class="mb-0">Edición del Reglamento: {{ reglamentoForm.nombre }}</h3>
            <p class="small mb-0">ID: {{ reglamentoForm._id }}</p>
        </div>
        <div class="card-body p-4">
            
            <form #reglamentoFormRef="ngForm" (ngSubmit)="guardarCambios(reglamentoFormRef)">
                
                <div class="mb-3">
                    <label for="reglamento_id" class="form-label">ID Numérico (Reglamento)</label>
                    <!-- Es readonly para que el admin no lo cambie -->
                    <input type="number" 
                           id="reglamento_id" 
                           name="reglamento_id" 
                           class="form-control" 
                           [(ngModel)]="reglamentoForm.reglamento_id_num" 
                           readonly
                           required>
                </div>
                
                <div class="mb-3">
                    <label for="nombre" class="form-label">Nombre del Reglamento</label>
                    <input type="text" 
                           id="nombre" 
                           name="nombre" 
                           class="form-control" 
                           [(ngModel)]="reglamentoForm.nombre" 
                           required>
                </div>
                
                <div class="mb-3">
                    <label for="descripcion" class="form-label">Descripción</label>
                    <textarea id="descripcion" 
                              name="descripcion" 
                              class="form-control" 
                              rows="3"
                              [(ngModel)]="reglamentoForm.descripcion" 
                              required></textarea>
                </div>
                
                <div class="mb-3">
                    <label for="estado" class="form-label">Estado</label>
                    <select id="estado" 
                            name="estado" 
                            class="form-select" 
                            [(ngModel)]="reglamentoForm.estado" 
                            required>
                        <option value="activo">Activo</option>
                        <option value="inactivo">Inactivo</option>
                    </select>
                </div>

                <hr>

                <div class="mb-4 p-3 border rounded bg-light">
                    <h5 class="mb-3">Actualizar Archivo PDF</h5>
                    <div class="mb-3">
                        <label for="pdfFile" class="form-label">Seleccionar Nuevo PDF</label>
                        <input type="file" 
                               id="pdfFile" 
                               class="form-control" 
                               accept="application/pdf"
                               (change)="onFileChange($event)">
                        <div class="form-text mt-2">
                            <i class="bi bi-file-earmark-pdf"></i> PDF Actual: 
                            <a [href]="reglamentoForm.pdf_url" target="_blank">{{ reglamentoForm.pdf_url | slice:0:50 }}...</a>
                        </div>
                    </div>
                </div>

                <div class="d-flex justify-content-end">
                    <button type="submit" class="btn btn-success btn-lg" [disabled]="isSaving || reglamentoFormRef.invalid">
                        <span *ngIf="!isSaving"><i class="bi bi-save"></i> Guardar Cambios</span>
                        <span *ngIf="isSaving">Guardando...</span>
                    </button>
                </div>

            </form>

        </div>
    </div>
</div>