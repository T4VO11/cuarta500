<div class="container mt-4">
    <button class="btn btn-success mb-4" (click)="regresar()">
        <i class="bi bi-arrow-left"></i> Regresar a Lista de Bitácoras
    </button>

    <div *ngIf="isLoading" class="alert alert-info">Cargando detalles del registro</div>

    <div *ngIf="bitacora" class="card shadow-lg border-0 rounded-4">
        <div class="card-header bg-success text-white">
            <h3 class="mb-0">Registro de Bitácora #{{ bitacora.registro_id }}</h3>
        </div>
        <div class="card-body p-4">
            
            <div class="row">
                <!-- Columna 1: Información General -->
                <div class="col-md-6 border-end">
                    <h4 class="text-dark">Detalle del Evento</h4>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item"><strong>Tipo de Registro:</strong> <span class="badge bg-secondary">{{ bitacora.tipo_registro | titlecase }}</span></li>
                        <li class="list-group-item"><strong>Fecha y Hora:</strong> {{ bitacora.fecha_hora | date: 'medium' }}</li>
                        <li class="list-group-item"><strong>Acción Realizada:</strong> {{ bitacora.accion | titlecase }}</li>
                        <li class="list-group-item"><strong>ID de Usuario:</strong> {{ bitacora.usuario_id }}</li>
                    </ul>
                </div>
                
                <!-- Columna 2: Detalle de Acceso -->
                <div class="col-md-6">
                    <h4 class="text-dark">Detalles de Acceso</h4>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item"><strong>Método de Acceso:</strong> {{ bitacora.detalle_acceso?.metodo || 'N/A' }}</li>
                        <li class="list-group-item"><strong>No. de Casa:</strong> {{ bitacora.detalle_acceso?.numeroCasa || 'N/A' }}</li>
                        <li class="list-group-item"><strong>Placas:</strong> {{ bitacora.detalle_acceso?.placas || 'N/A' }}</li>
                        <li class="list-group-item"><strong>Visitante:</strong> {{ bitacora.detalle_acceso?.nombre_visitante || 'N/A' }}</li>
                    </ul>
                </div>
            </div>
            
            <h4 class="mt-4 border-bottom pb-2">Evidencia de Acceso</h4>
            <div class="row pt-3">
                <div class="col-md-6">
                    <!-- Muestra la imagen INE/Foto si existe -->
                    <div *ngIf="getImagenUrl(bitacora)">
                        <h5 class="small text-muted">Foto de Acceso / INE</h5>
                       <img *ngIf="bitacora.detalle_acceso?.imagen_ine_url" 
     [src]="getImagenUrl(bitacora.detalle_acceso.imagen_ine_url)" 
     alt="INE" class="img-fluid">

                    </div>
                    <div *ngIf="!getImagenUrl(bitacora)">
                        <p class="text-muted">No se adjuntó evidencia visual.</p>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>