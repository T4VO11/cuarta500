<h2 class="mb-4">Gestión de Reservaciones</h2>

<div class="d-flex justify-content-end mb-3">
    <!-- El botón de crear reservación se hace desde la vista de Amenidades (Reservar) -->
    <p class="text-muted small">Las reservaciones se crean desde la lista de Amenidades (Terraza).</p>
</div>

<div class="table-responsive shadow-sm">
  <table class="table table-striped table-hover align-middle">
    <thead>
      <tr>
        <th>ID</th>
        <th>Residente</th>
        <th>Teléfono</th>
        <th>Fecha Evento</th>
        <th>Total</th>
        <th>Pago</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let reservacion of reservaciones">
        <td>{{ reservacion.reservacion_id }}</td>
        <td>{{ reservacion.nombre_residente }}</td>
        <td>{{ reservacion.telefono }}</td>
        <td>{{ reservacion.fecha_evento | date: 'mediumDate' }}</td>
        <td>${{ reservacion.total | number:'1.2-2' }} MXN</td>
        <td><span class="badge" [ngClass]="{'bg-success': reservacion.estado_pago === 'pagado', 'bg-warning text-dark': reservacion.estado_pago === 'pendiente'}">{{ reservacion.estado_pago | titlecase }}</span></td>
        <td><span class="badge bg-secondary">{{ reservacion.estado | titlecase }}</span></td>
        
        <!-- Acciones -->
            <td>

            <button *ngIf="reservacion.estado_pago === 'pendiente'"
              class="btn btn-sm btn-success me-2" 
              (click)="pagarReservacion(reservacion)"
              title="Pagar con tarjeta">
              <i class="bi bi-credit-card-2-front"></i> Pagar
            </button>
             <!-- Detalle (Show) -->
            <a [routerLink]="['/main/reservaciones/show', reservacion._id]" class="btn btn-sm btn-secondary me-2">
                <i class="bi bi-eye"></i> Detalle
            </a>
            <!--  Editar -->
            <a *ngIf="isAdmin"
                [routerLink]="['/main/reservaciones/edit', reservacion._id]" class="btn btn-sm btn-warning me-2">
                <i class="bi bi-pencil-square"></i> Editar
            </a>
            <!-- Eliminar -->
            <button *ngIf="isAdmin"
                class="btn btn-sm btn-danger" (click)="deleteReservacion(reservacion._id)">
                <i class="bi bi-trash"></i> Eliminar
            </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>